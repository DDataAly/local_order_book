# ğŸ“ˆ Local Order Book â€“ Binance WebSockets Stream

## ğŸ”° Overview
An asynchronous Python project that creates and maintains a **local copy of Binanceâ€™s order book** in real time using WebSocket depth update streams.  
It verifies the consistency of the local order book by synchronizing with Binance REST API snapshots and performing checksum validations.

## ğŸ”§ Tech Stack
**Language**  
- Python 3.13

**Core Libraries**  
- `asyncio` â€“ event loop for concurrency  
- `websockets` â€“ connection to Binance WebSocket streams  
- `aiohttp` â€“ asynchronous REST API requests (order book snapshots)  
- `bisect` â€“ maintaining sorted price lists efficiently  
- `logging` â€“ event and error tracking  
- `pytest` â€“ unit testing of order book logic  

**Design & Architecture**  
- Object-Oriented Design with an `OrderBook` class  
- Asynchronous ingestion, synchronization, and processing pipelines  
- Modular file structure with separation of concerns  

## ğŸ“Š How It Works
1. **Subscribe** to Binance WebSocket depth update streams  
2. **Ingest** depth updates into a local buffer  
3. **Sync** the buffer with a REST API snapshot to ensure consistency  
4. **Process** updates to maintain a local order book object  
   - Dictionary of prices/quantities for bids and asks  
   - Lists of best bid/ask prices for fast access  
5. **Validate** the local order book by running checksum checks *(in progress)*  

## ğŸš€ Project Milestones (Work in Progress)

- âœ… Connect to Binance WebSockets  
- âœ… Ingest WebSocket depth update messages into a local buffer  
- âœ… Get a snapshot of the order book from Binance REST API  
- âœ… Synchronize WebSocket updates with the snapshot  
- âœ… Define the `OrderBook` class  
- âœ… Implement processing logic for order book updates  
   - Dictionary of asks/bids with prices and quantities  
   - Lists of best bid/ask prices  
- âœ… Test processing logic thoroughly  
- ğŸš§ Integrate all components into a single async event loop  
- â³ Test the async event loop  
- â³ Implement checksum validation  
- â³ Replace print statements with structured logging  
- â³ Implement buffer size monitoring  
- â³ Add client-facing order book snapshot requests  
- â³ Design data flows for saving snapshots and automated validations  
- â³ Ensure clean Pythonic project structure  

---

## â–¶ï¸ Usage Instructions
Run the main event loop:
```bash
python main.py
```


## ğŸ–¥ï¸ Demo Output - tests

![Core logic tests output](data/tests_output_order_book_class.png)

## ğŸ“ File Structure
Run the main event loop:
```
local_order_book/
â”‚
â”œâ”€â”€ main.py                        # Entry point
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ wb_sockets/               # WebSockets related code
â”‚   â”‚   â”œâ”€â”€ subscribing.py        # subscribing to the WebSockets stream
â”‚   â”‚   â”œâ”€â”€ ingesting.py          # ws_ingestion logic (save depth update messages to the local buffer)
â”‚   â”‚   â”œâ”€â”€ syncing.py            # match the depth update messages to the order book snapshot 
â”‚   â”‚   â””â”€â”€ processing.py         # ws_processing logic (apply updates to OrderBook)
â”‚   â”‚
â”‚   â”œâ”€â”€ order_book/               # Order book domain logic
â”‚   â”‚    â””â”€â”€ order_book_class.py  # OrderBook class and update methods
â”‚   â”‚
â”‚   â””â”€â”€ utils/                    # Reusable helpers
â”‚      â”œâ”€â”€ logger.py              # logging setup
â”‚      â””â”€â”€ helpers.py             # miscellaneous utilities (path finder at this stage)
â”‚
â”œâ”€â”€ tests/                        # Unit tests
â”‚    â””â”€â”€ test_order_book.py       # core processing logic test
â”‚
â”œâ”€â”€ .gitignore
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

